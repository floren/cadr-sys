;;; -*- Mode:Lisp; Readtable:ZL; Package:FILE-SYSTEM; Base:10; Patch-File:T -*-
;;; Patch file for Local-File version 74.2
;;; Reason:
;;;  The :map-nblocks method of a map-output-stream shouldn't blow up if the
;;;  stream is closed and there is no map.
;;; Written 14-Jun-88 11:22:14 by pld at site Gigamos Cambridge
;;; while running on Breaking Glass from band 3
;;; with Experimental System 124.50, Experimental Local-File 74.1, Experimental File-Server 23.1, Experimental Unix-Interface 12.0, Experimental ZMail 72.0, Experimental Tape 23.6, Experimental Lambda-Diag 16.1, microcode 1759, SDU Boot Tape 3.14, SDU ROM 103.



; From modified file DJ: L.FILE; FSSTR.LISP#114 at 14-Jun-88 11:22:37
#10R FILE-SYSTEM#: 
(COMPILER-LET ((*PACKAGE* (PKG-FIND-PACKAGE "FILE-SYSTEM")))
  (COMPILER::PATCH-SOURCE-FILE "SYS: FILE; FSSTR  "

(DEFMETHOD (MAP-OUTPUT-STREAM-MIXIN :MAP-NBLOCKS) ()
  (AND MAP
       (MAP-NBLOCKS MAP)))

))
